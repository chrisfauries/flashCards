import { CARD_ACCIDENTAL_MAP } from "./cards";

export enum CLEF {
  TREBLE,
  BASS,
}

export enum ACCIDENTAL {
  FLAT,
  NATURAL,
  SHARP,
}

export enum OCTAVE {
  FIRST,
  SECOND,
  THIRD,
  FOURTH,
  FIFTH,
  SIXTH,
  SEVENTH,
}

export enum NOTE_NAME {
  A_FLAT,
  A_NATURAL,
  A_SHARP,
  B_FLAT,
  B_NATURAL,
  C_NATURAL,
  C_SHARP,
  D_FLAT,
  D_NATURAL,
  D_SHARP,
  E_FLAT,
  E_NATURAL,
  F_NATURAL,
  F_SHARP,
  G_FLAT,
  G_NATURAL,
  G_SHARP,
}

export const NOTE_NAME_STRING_MAP: { [key in NOTE_NAME]: string } = {
  [NOTE_NAME.A_FLAT]: "A♭",
  [NOTE_NAME.A_NATURAL]: "A",
  [NOTE_NAME.A_SHARP]: "A♯",
  [NOTE_NAME.B_FLAT]: "B♭",
  [NOTE_NAME.B_NATURAL]: "B",
  [NOTE_NAME.C_NATURAL]: "C",
  [NOTE_NAME.C_SHARP]: "C♯",
  [NOTE_NAME.D_FLAT]: "D♭",
  [NOTE_NAME.D_NATURAL]: "D",
  [NOTE_NAME.D_SHARP]: "D♯",
  [NOTE_NAME.E_FLAT]: "E♭",
  [NOTE_NAME.E_NATURAL]: "E",
  [NOTE_NAME.F_NATURAL]: "F",
  [NOTE_NAME.F_SHARP]: "F♯",
  [NOTE_NAME.G_FLAT]: "G♭",
  [NOTE_NAME.G_NATURAL]: "G",
  [NOTE_NAME.G_SHARP]: "G♯",
};

export enum PITCH {
  F_NATURAL_1,
  F_SHARP_G_FLAT_1,
  G_NATURAL_1,
  G_SHARP_A_FLAT_1,
  A_NATURAL_1,
  A_SHARP_B_FLAT_1,
  B_NATURAL_1,
  C_NATURAL_2,
  C_SHARP_D_FLAT_2,
  D_NATURAL_2,
  D_SHARP_E_FLAT_2,
  E_NATURAL_2,
  F_NATURAL_2,
  F_SHARP_G_FLAT_2,
  G_NATURAL_2,
  G_SHARP_A_FLAT_2,
  A_NATURAL_2,
  A_SHARP_B_FLAT_2,
  B_NATURAL_2,
  C_NATURAL_3,
  C_SHARP_D_FLAT_3,
  D_NATURAL_3,
  D_SHARP_E_FLAT_3,
  E_NATURAL_3,
  F_NATURAL_3,
  F_SHARP_G_FLAT_3,
  G_NATURAL_3,
  G_SHARP_A_FLAT_3,
  A_NATURAL_3,
  A_SHARP_B_FLAT_3,
  B_NATURAL_3,
  C_NATURAL_4,
  C_SHARP_D_FLAT_4,
  D_NATURAL_4,
  D_SHARP_E_FLAT_4,
  E_NATURAL_4,
  F_NATURAL_4,
  F_SHARP_G_FLAT_4,
  G_NATURAL_4,
  G_SHARP_A_FLAT_4,
  A_NATURAL_4,
  A_SHARP_B_FLAT_4,
  B_NATURAL_4,
  C_NATURAL_5,
  C_SHARP_D_FLAT_5,
  D_NATURAL_5,
  D_SHARP_E_FLAT_5,
  E_NATURAL_5,
  F_NATURAL_5,
  F_SHARP_G_FLAT_5,
  G_NATURAL_5,
  G_SHARP_A_FLAT_5,
  A_NATURAL_5,
  A_SHARP_B_FLAT_5,
  B_NATURAL_5,
  C_NATURAL_6,
  C_SHARP_D_FLAT_6,
  D_NATURAL_6,
  D_SHARP_E_FLAT_6,
  E_NATURAL_6,
  F_NATURAL_6,
  F_SHARP_G_FLAT_6,
  G_NATURAL_6,
  G_SHARP_A_FLAT_6,
  A_NATURAL_6,
  A_SHARP_B_FLAT_6,
  B_NATURAL_6,
  C_NATURAL_7,
}

export const PITCH_TO_OCTAVE_MAP: { [key in PITCH]: OCTAVE } = {
  [PITCH.F_NATURAL_1]: OCTAVE.FIRST,
  [PITCH.F_SHARP_G_FLAT_1]: OCTAVE.FIRST,
  [PITCH.G_NATURAL_1]: OCTAVE.FIRST,
  [PITCH.G_SHARP_A_FLAT_1]: OCTAVE.FIRST,
  [PITCH.A_NATURAL_1]: OCTAVE.FIRST,
  [PITCH.A_SHARP_B_FLAT_1]: OCTAVE.FIRST,
  [PITCH.B_NATURAL_1]: OCTAVE.FIRST,
  [PITCH.C_NATURAL_2]: OCTAVE.SECOND,
  [PITCH.C_SHARP_D_FLAT_2]: OCTAVE.SECOND,
  [PITCH.D_NATURAL_2]: OCTAVE.SECOND,
  [PITCH.D_SHARP_E_FLAT_2]: OCTAVE.SECOND,
  [PITCH.E_NATURAL_2]: OCTAVE.SECOND,
  [PITCH.F_NATURAL_2]: OCTAVE.SECOND,
  [PITCH.F_SHARP_G_FLAT_2]: OCTAVE.SECOND,
  [PITCH.G_NATURAL_2]: OCTAVE.SECOND,
  [PITCH.G_SHARP_A_FLAT_2]: OCTAVE.SECOND,
  [PITCH.A_NATURAL_2]: OCTAVE.SECOND,
  [PITCH.A_SHARP_B_FLAT_2]: OCTAVE.SECOND,
  [PITCH.B_NATURAL_2]: OCTAVE.SECOND,
  [PITCH.C_NATURAL_3]: OCTAVE.THIRD,
  [PITCH.C_SHARP_D_FLAT_3]: OCTAVE.THIRD,
  [PITCH.D_NATURAL_3]: OCTAVE.THIRD,
  [PITCH.D_SHARP_E_FLAT_3]: OCTAVE.THIRD,
  [PITCH.E_NATURAL_3]: OCTAVE.THIRD,
  [PITCH.F_NATURAL_3]: OCTAVE.THIRD,
  [PITCH.F_SHARP_G_FLAT_3]: OCTAVE.THIRD,
  [PITCH.G_NATURAL_3]: OCTAVE.THIRD,
  [PITCH.G_SHARP_A_FLAT_3]: OCTAVE.THIRD,
  [PITCH.A_NATURAL_3]: OCTAVE.THIRD,
  [PITCH.A_SHARP_B_FLAT_3]: OCTAVE.THIRD,
  [PITCH.B_NATURAL_3]: OCTAVE.THIRD,
  [PITCH.C_NATURAL_4]: OCTAVE.FOURTH,
  [PITCH.C_SHARP_D_FLAT_4]: OCTAVE.FOURTH,
  [PITCH.D_NATURAL_4]: OCTAVE.FOURTH,
  [PITCH.D_SHARP_E_FLAT_4]: OCTAVE.FOURTH,
  [PITCH.E_NATURAL_4]: OCTAVE.FOURTH,
  [PITCH.F_NATURAL_4]: OCTAVE.FOURTH,
  [PITCH.F_SHARP_G_FLAT_4]: OCTAVE.FOURTH,
  [PITCH.G_NATURAL_4]: OCTAVE.FOURTH,
  [PITCH.G_SHARP_A_FLAT_4]: OCTAVE.FOURTH,
  [PITCH.A_NATURAL_4]: OCTAVE.FOURTH,
  [PITCH.A_SHARP_B_FLAT_4]: OCTAVE.FOURTH,
  [PITCH.B_NATURAL_4]: OCTAVE.FOURTH,
  [PITCH.C_NATURAL_5]: OCTAVE.FIFTH,
  [PITCH.C_SHARP_D_FLAT_5]: OCTAVE.FIFTH,
  [PITCH.D_NATURAL_5]: OCTAVE.FIFTH,
  [PITCH.D_SHARP_E_FLAT_5]: OCTAVE.FIFTH,
  [PITCH.E_NATURAL_5]: OCTAVE.FIFTH,
  [PITCH.F_NATURAL_5]: OCTAVE.FIFTH,
  [PITCH.F_SHARP_G_FLAT_5]: OCTAVE.FIFTH,
  [PITCH.G_NATURAL_5]: OCTAVE.FIFTH,
  [PITCH.G_SHARP_A_FLAT_5]: OCTAVE.FIFTH,
  [PITCH.A_NATURAL_5]: OCTAVE.FIFTH,
  [PITCH.A_SHARP_B_FLAT_5]: OCTAVE.FIFTH,
  [PITCH.B_NATURAL_5]: OCTAVE.FIFTH,
  [PITCH.C_NATURAL_6]: OCTAVE.SIXTH,
  [PITCH.C_SHARP_D_FLAT_6]: OCTAVE.SIXTH,
  [PITCH.D_NATURAL_6]: OCTAVE.SIXTH,
  [PITCH.D_SHARP_E_FLAT_6]: OCTAVE.SIXTH,
  [PITCH.E_NATURAL_6]: OCTAVE.SIXTH,
  [PITCH.F_NATURAL_6]: OCTAVE.SIXTH,
  [PITCH.F_SHARP_G_FLAT_6]: OCTAVE.SIXTH,
  [PITCH.G_NATURAL_6]: OCTAVE.SIXTH,
  [PITCH.G_SHARP_A_FLAT_6]: OCTAVE.SIXTH,
  [PITCH.A_NATURAL_6]: OCTAVE.SIXTH,
  [PITCH.A_SHARP_B_FLAT_6]: OCTAVE.SIXTH,
  [PITCH.B_NATURAL_6]: OCTAVE.SIXTH,
  [PITCH.C_NATURAL_7]: OCTAVE.SEVENTH,
};

export const PITCH_TO_NOTE_NAMES_MAP: {
  [key in PITCH]: { [key in ACCIDENTAL]?: NOTE_NAME };
} = {
  [PITCH.F_NATURAL_1]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.F_NATURAL },
  [PITCH.F_SHARP_G_FLAT_1]: {
    [ACCIDENTAL.SHARP]: NOTE_NAME.F_SHARP,
    [ACCIDENTAL.FLAT]: NOTE_NAME.G_FLAT,
  },
  [PITCH.G_NATURAL_1]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.G_NATURAL },
  [PITCH.G_SHARP_A_FLAT_1]: {
    [ACCIDENTAL.SHARP]: NOTE_NAME.G_SHARP,
    [ACCIDENTAL.FLAT]: NOTE_NAME.A_FLAT,
  },
  [PITCH.A_NATURAL_1]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.A_NATURAL },
  [PITCH.A_SHARP_B_FLAT_1]: {
    [ACCIDENTAL.SHARP]: NOTE_NAME.A_SHARP,
    [ACCIDENTAL.FLAT]: NOTE_NAME.B_FLAT,
  },
  [PITCH.B_NATURAL_1]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.B_NATURAL },
  [PITCH.C_NATURAL_2]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.C_NATURAL },
  [PITCH.C_SHARP_D_FLAT_2]: {
    [ACCIDENTAL.SHARP]: NOTE_NAME.C_SHARP,
    [ACCIDENTAL.FLAT]: NOTE_NAME.D_FLAT,
  },
  [PITCH.D_NATURAL_2]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.D_NATURAL },
  [PITCH.D_SHARP_E_FLAT_2]: {
    [ACCIDENTAL.SHARP]: NOTE_NAME.D_SHARP,
    [ACCIDENTAL.FLAT]: NOTE_NAME.E_FLAT,
  },
  [PITCH.E_NATURAL_2]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.E_NATURAL },
  [PITCH.F_NATURAL_2]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.F_NATURAL },
  [PITCH.F_SHARP_G_FLAT_2]: {
    [ACCIDENTAL.SHARP]: NOTE_NAME.F_SHARP,
    [ACCIDENTAL.FLAT]: NOTE_NAME.G_FLAT,
  },
  [PITCH.G_NATURAL_2]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.G_NATURAL },
  [PITCH.G_SHARP_A_FLAT_2]: {
    [ACCIDENTAL.SHARP]: NOTE_NAME.G_SHARP,
    [ACCIDENTAL.FLAT]: NOTE_NAME.A_FLAT,
  },
  [PITCH.A_NATURAL_2]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.A_NATURAL },
  [PITCH.A_SHARP_B_FLAT_2]: {
    [ACCIDENTAL.SHARP]: NOTE_NAME.A_SHARP,
    [ACCIDENTAL.FLAT]: NOTE_NAME.B_FLAT,
  },
  [PITCH.B_NATURAL_2]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.B_NATURAL },
  [PITCH.C_NATURAL_3]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.C_NATURAL },
  [PITCH.C_SHARP_D_FLAT_3]: {
    [ACCIDENTAL.SHARP]: NOTE_NAME.C_SHARP,
    [ACCIDENTAL.FLAT]: NOTE_NAME.D_FLAT,
  },
  [PITCH.D_NATURAL_3]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.D_NATURAL },
  [PITCH.D_SHARP_E_FLAT_3]: {
    [ACCIDENTAL.SHARP]: NOTE_NAME.D_SHARP,
    [ACCIDENTAL.FLAT]: NOTE_NAME.E_FLAT,
  },
  [PITCH.E_NATURAL_3]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.E_NATURAL },
  [PITCH.F_NATURAL_3]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.F_NATURAL },
  [PITCH.F_SHARP_G_FLAT_3]: {
    [ACCIDENTAL.SHARP]: NOTE_NAME.F_SHARP,
    [ACCIDENTAL.FLAT]: NOTE_NAME.G_FLAT,
  },
  [PITCH.G_NATURAL_3]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.G_NATURAL },
  [PITCH.G_SHARP_A_FLAT_3]: {
    [ACCIDENTAL.SHARP]: NOTE_NAME.G_SHARP,
    [ACCIDENTAL.FLAT]: NOTE_NAME.A_FLAT,
  },
  [PITCH.A_NATURAL_3]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.A_NATURAL },
  [PITCH.A_SHARP_B_FLAT_3]: {
    [ACCIDENTAL.SHARP]: NOTE_NAME.A_SHARP,
    [ACCIDENTAL.FLAT]: NOTE_NAME.B_FLAT,
  },
  [PITCH.B_NATURAL_3]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.B_NATURAL },
  [PITCH.C_NATURAL_4]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.C_NATURAL },
  [PITCH.C_SHARP_D_FLAT_4]: {
    [ACCIDENTAL.SHARP]: NOTE_NAME.C_SHARP,
    [ACCIDENTAL.FLAT]: NOTE_NAME.D_FLAT,
  },
  [PITCH.D_NATURAL_4]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.D_NATURAL },
  [PITCH.D_SHARP_E_FLAT_4]: {
    [ACCIDENTAL.SHARP]: NOTE_NAME.D_SHARP,
    [ACCIDENTAL.FLAT]: NOTE_NAME.E_FLAT,
  },
  [PITCH.E_NATURAL_4]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.E_NATURAL },
  [PITCH.F_NATURAL_4]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.F_NATURAL },
  [PITCH.F_SHARP_G_FLAT_4]: {
    [ACCIDENTAL.SHARP]: NOTE_NAME.F_SHARP,
    [ACCIDENTAL.FLAT]: NOTE_NAME.G_FLAT,
  },
  [PITCH.G_NATURAL_4]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.G_NATURAL },
  [PITCH.G_SHARP_A_FLAT_4]: {
    [ACCIDENTAL.SHARP]: NOTE_NAME.G_SHARP,
    [ACCIDENTAL.FLAT]: NOTE_NAME.A_FLAT,
  },
  [PITCH.A_NATURAL_4]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.A_NATURAL },
  [PITCH.A_SHARP_B_FLAT_4]: {
    [ACCIDENTAL.SHARP]: NOTE_NAME.A_SHARP,
    [ACCIDENTAL.FLAT]: NOTE_NAME.B_FLAT,
  },
  [PITCH.B_NATURAL_4]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.B_NATURAL },
  [PITCH.C_NATURAL_5]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.C_NATURAL },
  [PITCH.C_SHARP_D_FLAT_5]: {
    [ACCIDENTAL.SHARP]: NOTE_NAME.C_SHARP,
    [ACCIDENTAL.FLAT]: NOTE_NAME.D_FLAT,
  },
  [PITCH.D_NATURAL_5]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.D_NATURAL },
  [PITCH.D_SHARP_E_FLAT_5]: {
    [ACCIDENTAL.SHARP]: NOTE_NAME.D_SHARP,
    [ACCIDENTAL.FLAT]: NOTE_NAME.E_FLAT,
  },
  [PITCH.E_NATURAL_5]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.E_NATURAL },
  [PITCH.F_NATURAL_5]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.F_NATURAL },
  [PITCH.F_SHARP_G_FLAT_5]: {
    [ACCIDENTAL.SHARP]: NOTE_NAME.F_SHARP,
    [ACCIDENTAL.FLAT]: NOTE_NAME.G_FLAT,
  },
  [PITCH.G_NATURAL_5]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.G_NATURAL },
  [PITCH.G_SHARP_A_FLAT_5]: {
    [ACCIDENTAL.SHARP]: NOTE_NAME.G_SHARP,
    [ACCIDENTAL.FLAT]: NOTE_NAME.A_FLAT,
  },
  [PITCH.A_NATURAL_5]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.A_NATURAL },
  [PITCH.A_SHARP_B_FLAT_5]: {
    [ACCIDENTAL.SHARP]: NOTE_NAME.A_SHARP,
    [ACCIDENTAL.FLAT]: NOTE_NAME.B_FLAT,
  },
  [PITCH.B_NATURAL_5]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.B_NATURAL },
  [PITCH.C_NATURAL_6]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.C_NATURAL },
  [PITCH.C_SHARP_D_FLAT_6]: {
    [ACCIDENTAL.SHARP]: NOTE_NAME.C_SHARP,
    [ACCIDENTAL.FLAT]: NOTE_NAME.D_FLAT,
  },
  [PITCH.D_NATURAL_6]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.D_NATURAL },
  [PITCH.D_SHARP_E_FLAT_6]: {
    [ACCIDENTAL.SHARP]: NOTE_NAME.D_SHARP,
    [ACCIDENTAL.FLAT]: NOTE_NAME.E_FLAT,
  },
  [PITCH.E_NATURAL_6]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.E_NATURAL },
  [PITCH.F_NATURAL_6]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.F_NATURAL },
  [PITCH.F_SHARP_G_FLAT_6]: {
    [ACCIDENTAL.SHARP]: NOTE_NAME.F_SHARP,
    [ACCIDENTAL.FLAT]: NOTE_NAME.G_FLAT,
  },
  [PITCH.G_NATURAL_6]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.G_NATURAL },
  [PITCH.G_SHARP_A_FLAT_6]: {
    [ACCIDENTAL.SHARP]: NOTE_NAME.G_SHARP,
    [ACCIDENTAL.FLAT]: NOTE_NAME.A_FLAT,
  },
  [PITCH.A_NATURAL_6]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.A_NATURAL },
  [PITCH.A_SHARP_B_FLAT_6]: {
    [ACCIDENTAL.SHARP]: NOTE_NAME.A_SHARP,
    [ACCIDENTAL.FLAT]: NOTE_NAME.B_FLAT,
  },
  [PITCH.B_NATURAL_6]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.B_NATURAL },
  [PITCH.C_NATURAL_7]: { [ACCIDENTAL.NATURAL]: NOTE_NAME.C_NATURAL },
};


export const getPitch = (cardMap: CARD_ACCIDENTAL_MAP): PITCH => {
  const pitches = new Set(Object.values(cardMap).map(card => card.pitch));
  if (pitches.size === 1) {
    return pitches.values().next().value as PITCH;
  } else {
    throw new Error("could not determine pitch from card map")
  } 
} 