import { INSTRUMENT } from "./instruments/instrument";
import { PITCH } from "./pitch";

export const CONCERT_PITCH_FREQUENCY_MAP: { [key in PITCH]: number } = {
  [PITCH.F_NATURAL_1]: 43.654,
  [PITCH.F_SHARP_G_FLAT_1]: 46.249,
  [PITCH.G_NATURAL_1]: 48.999,
  [PITCH.G_SHARP_A_FLAT_1]: 51.913,
  [PITCH.A_NATURAL_1]: 55.0,
  [PITCH.A_SHARP_B_FLAT_1]: 58.27,
  [PITCH.B_NATURAL_1]: 61.735,
  [PITCH.C_NATURAL_2]: 65.406,
  [PITCH.C_SHARP_D_FLAT_2]: 69.296,
  [PITCH.D_NATURAL_2]: 73.416,
  [PITCH.D_SHARP_E_FLAT_2]: 77.782,
  [PITCH.E_NATURAL_2]: 82.407,
  [PITCH.F_NATURAL_2]: 87.307,
  [PITCH.F_SHARP_G_FLAT_2]: 92.499,
  [PITCH.G_NATURAL_2]: 97.999,
  [PITCH.G_SHARP_A_FLAT_2]: 103.83,
  [PITCH.A_NATURAL_2]: 110.0,
  [PITCH.A_SHARP_B_FLAT_2]: 116.54,
  [PITCH.B_NATURAL_2]: 123.47,
  [PITCH.C_NATURAL_3]: 130.81,
  [PITCH.C_SHARP_D_FLAT_3]: 138.59,
  [PITCH.D_NATURAL_3]: 146.83,
  [PITCH.D_SHARP_E_FLAT_3]: 155.56,
  [PITCH.E_NATURAL_3]: 164.81,
  [PITCH.F_NATURAL_3]: 174.61,
  [PITCH.F_SHARP_G_FLAT_3]: 185.0,
  [PITCH.G_NATURAL_3]: 196.0,
  [PITCH.G_SHARP_A_FLAT_3]: 207.65,
  [PITCH.A_NATURAL_3]: 220.0,
  [PITCH.A_SHARP_B_FLAT_3]: 233.08,
  [PITCH.B_NATURAL_3]: 246.94,
  [PITCH.C_NATURAL_4]: 261.63,
  [PITCH.C_SHARP_D_FLAT_4]: 277.18,
  [PITCH.D_NATURAL_4]: 293.67,
  [PITCH.D_SHARP_E_FLAT_4]: 311.13,
  [PITCH.E_NATURAL_4]: 329.63,
  [PITCH.F_NATURAL_4]: 349.23,
  [PITCH.F_SHARP_G_FLAT_4]: 369.99,
  [PITCH.G_NATURAL_4]: 392.0,
  [PITCH.G_SHARP_A_FLAT_4]: 415.3,
  [PITCH.A_NATURAL_4]: 440.0,
  [PITCH.A_SHARP_B_FLAT_4]: 466.16,
  [PITCH.B_NATURAL_4]: 493.88,
  [PITCH.C_NATURAL_5]: 523.25,
  [PITCH.C_SHARP_D_FLAT_5]: 554.37,
  [PITCH.D_NATURAL_5]: 587.33,
  [PITCH.D_SHARP_E_FLAT_5]: 622.25,
  [PITCH.E_NATURAL_5]: 659.26,
  [PITCH.F_NATURAL_5]: 698.46,
  [PITCH.F_SHARP_G_FLAT_5]: 739.99,
  [PITCH.G_NATURAL_5]: 783.99,
  [PITCH.G_SHARP_A_FLAT_5]: 830.61,
  [PITCH.A_NATURAL_5]: 880.0,
  [PITCH.A_SHARP_B_FLAT_5]: 932.33,
  [PITCH.B_NATURAL_5]: 987.77,
  [PITCH.C_NATURAL_6]: 1046.5,
  [PITCH.C_SHARP_D_FLAT_6]: 1108.7,
  [PITCH.D_NATURAL_6]: 1174.7,
  [PITCH.D_SHARP_E_FLAT_6]: 1244.5,
  [PITCH.E_NATURAL_6]: 1318.5,
  [PITCH.F_NATURAL_6]: 1396.9,
  [PITCH.F_SHARP_G_FLAT_6]: 1480.0,
  [PITCH.G_NATURAL_6]: 1568.0,
  [PITCH.G_SHARP_A_FLAT_6]: 1661.2,
  [PITCH.A_NATURAL_6]: 1760.0,
  [PITCH.A_SHARP_B_FLAT_6]: 1864.7,
  [PITCH.B_NATURAL_6]: 1975.5,
  [PITCH.C_NATURAL_7]: 2093.0,
};

// Direction from written pitch to concert frequency
export const INSTRUMENT_TRANSPOSITION_MAP: { [key in INSTRUMENT]: number } = {
  [INSTRUMENT.FLUTE]: 0,
  [INSTRUMENT.CLARINET]: -2,
  [INSTRUMENT.SAXOPHONE]: -9,
  [INSTRUMENT.OBOE]: 0,
  [INSTRUMENT.BASSOON]: 0,
  [INSTRUMENT.TRUMPET]: -2,
  [INSTRUMENT.HORN]: -7,
  [INSTRUMENT.TROMBONE]: 0,
  [INSTRUMENT.EUPHONIUM]: 0,
  [INSTRUMENT.TUBA]: 0,
  [INSTRUMENT.PERCUSSION]: 0,
};

export const getFrequency = (instrument: INSTRUMENT, pitch: PITCH) => 
  CONCERT_PITCH_FREQUENCY_MAP[(pitch + INSTRUMENT_TRANSPOSITION_MAP[instrument]) as PITCH]
